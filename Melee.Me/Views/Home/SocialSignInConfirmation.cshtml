@model Melee.Me.Models.MeleeModel

@using LinqToTwitter
@{
    ViewBag.Title = "SocialSignInConfirmation";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Prepare to Melee</h2>

<div class="battleField">
        <div id="userContainer" class="userContainer">
            <img id="challengerImageUrl"src=@Model.Challenger.ImageUrl />
            <div id="challengerScreenName">@Model.Challenger.ScreenName</div>
            <div id="challengerBattleStats "class="battleStats">
                <label id="challengerMeleeTotal">Melee's: @(Model.Challenger.Stats.BattleWins + @Model.Challenger.Stats.BattleLosses)</label>
                <label id="challengerMeleeWins">Wins: @Model.Challenger.Stats.BattleWins</label>
                <label id="challengerMeleeLosses">Losses: @Model.Challenger.Stats.BattleLosses</label>
            @*    <label>Last Melee: @Model.Challenger.Stats.LastMelee</label>*@
            </div>
        </div>

        <div class="spacer">VS.</div>
    
        <div id="competitorContainer" class="competitorContainer">
            <img id="competitorImageUrl" src=@Model.Competitor.ImageUrl />
            <div id="competitorScreenName">@Model.Competitor.ScreenName</div>
            <div id="competitorBattleStats" class="battleStats">
                <label id="CompetitorMeleeTotal">Melee's: @(Model.Competitor.Stats.BattleWins + @Model.Competitor.Stats.BattleLosses)</label>
                <label id="CompetitorMeleeWins">Wins: @Model.Competitor.Stats.BattleWins</label>
                <label id="CompetitorMeleeLosses">Losses: @Model.Competitor.Stats.BattleLosses</label>
            @*    <label>Last Melee: @Model.Competitor.Stats.LastMelee</label>*@
            </div>
        </div>
    </div>

    
    <div class="actionControls">
        <button type="submit" name="NewOpponent" id="NewOpponent"value="NewOpponent" title="New Opponent">New</button>
        <button type="submit" name="Fight" value="Fight" title="Fight">Fight</button>   
    </div>
   

<script>
$('#NewOpponent').click(function(){
    $.ajax({
            url: '/Home/GetCompetitor',
            type: 'POST',
            data: { TwitterUserId: '@Model.Challenger.TwitterUserId' },
        success: function (result) {
            $('#competitorImageUrl').attr("src", result.ImageUrl);
            $('#competitorScreenName').html(result.ScreenName);
            $('#CompetitorMeleeTotal').html("Melee's: " + (result.Stats.BattleWins + result.Stats.BattleLosses));
            $('#CompetitorMeleeWins').html("Wins: " + result.Stats.BattleWins);
            $('#CompetitorMeleeLosses').html("Losses: " + result.Stats.BattleLosses)
        },
            error: function (jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect.\n Verify Network.');
                }
            },
            complete: function () {
                $('#spinnerBank').hide();
            }
    });

    return false;
});

</script>
